<div class="form-container">
  <form *ngIf="!isLoading" 
        (ngSubmit)="ajouterPaiement()" 
        #formPaiement="ngForm"
        class="paiement-form">

    <h2>Ajouter un paiement</h2>

    <!-- Faculté -->
    <div class="form-group">
      <label for="faculte">Faculté :</label>
      <select id="faculte" 
              [(ngModel)]="paiement.faculte" 
              name="faculte"
              required
              (change)="onFaculteChange()">
        <option value="">-- Sélectionnez une faculté --</option>
        <option *ngFor="let fac of facultes" [value]="fac">{{ fac }}</option>
      </select>
    </div>

    <!-- Étudiant -->
    <div class="form-group">
      <label for="etudiant">Étudiant :</label>
      <select id="etudiant" 
              [(ngModel)]="paiement.etudiantId" 
              name="etudiant"
              required
              (change)="onEtudiantChange()">
        <option value="">-- Sélectionnez un étudiant --</option>
        <option *ngFor="let etu of etudiantsFiltres" [value]="etu._id">{{ etu.nom }}</option>
      </select>
    </div>

    <!-- Frais à payer -->
<div class="form-group">
  <label for="description">Service à payer :</label> 
<select id="description"
        [(ngModel)]="serviceSelectionne"
        name="service"
        (change)="onFraisChange()"
        required>
  <option [ngValue]="null">-- Sélectionnez un service --</option>
  <option *ngFor="let service of servicesDisponibles" [ngValue]="service">
    {{ service.name }} 
  </option>
</select>
</div>


    <!-- Montant (grisé, forcé) -->
    <div class="form-group">
      <label for="montant">Montant :</label>
      <input type="number" 
             id="montant"
             [(ngModel)]="paiement.montant" 
             name="montant" 
             readonly
             class="readonly-input">
    </div>
<!-- Moyen de paiement -->
<div class="form-group">
  <label for="moyen">Moyen de paiement :</label>
  <select id="moyen" 
          [(ngModel)]="paiement.moyen" 
          name="moyen"
          required>
    <option value="">-- Sélectionnez un moyen --</option>
    <option *ngFor="let moyen of moyensPaiement" [value]="moyen.value">{{ moyen.label }}</option>
  </select>
</div>

    <!-- Pièces jointes -->
    <div class="form-group">
      <label for="piece">Pièces jointes :</label>
      <input type="file" 
             id="piece"
             (change)="onFileSelected($event)">
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button type="button" class="btn btn-cancel" routerLink="/paiements">Annuler</button>
      <button type="submit" class="btn btn-submit" [disabled]="formPaiement.invalid || isLoading">
        {{ isLoading ? 'Enregistrement...' : 'Ajouter' }}
      </button>
    </div>
  </form>
</div>

